<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <title>Ø¯ÙØ¹Ø§Øª Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</title>
    <base target="_top" />
    <? var appUrl = getUrl(); var url = appUrl; ?>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
      :root {
        --primary-color: #008891;
        --primary-dark: #006d75;
        --primary-light: #00a0a9;
        --text-dark: #2c3f3f;
        --text-muted: #6c757d;
        --bg-light: #f5f7fb;
        --card-shadow: 0 18px 60px rgba(0, 0, 0, 0.08);
      }

      * {
        font-family: 'Cairo', sans-serif;
      }

      body {
        background: var(--bg-light);
        min-height: 100vh;
        margin: 0;
      }

      .ghada-hero {
        position: relative;
        width: 100%;
        background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        color: #fff;
        padding: 24px clamp(12px, 5vw, 60px) 20px;
        overflow: hidden;
        box-shadow: var(--card-shadow);
        border-bottom-left-radius: 28px;
        border-bottom-right-radius: 28px;
        margin-bottom: 24px;
      }

      .ghada-hero::before,
      .ghada-hero::after {
        content: '';
        position: absolute;
        border-radius: 50%;
        background: #fff;
        opacity: 0.12;
        filter: blur(0.5px);
        pointer-events: none;
      }

      .ghada-hero::before {
        width: 320px;
        height: 320px;
        top: -160px;
        left: -60px;
      }

      .ghada-hero::after {
        width: 220px;
        height: 220px;
        bottom: -120px;
        right: -30px;
      }

      .ghada-hero-content {
        position: relative;
        z-index: 1;
        display: flex;
        flex-wrap: wrap;
        gap: 18px;
        align-items: center;
        justify-content: space-between;
      }

      .ghada-hero-emoji {
        font-size: 2.2rem;
        background: rgba(255, 255, 255, 0.16);
        border-radius: 20px;
        padding: 12px 18px;
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2);
      }

      .ghada-hero-text {
        max-width: 640px;
        color: #fff;
      }

      .ghada-hero-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.25);
        border-radius: 999px;
        padding: 6px 16px;
        font-size: 0.85rem;
        font-weight: 600;
        margin-bottom: 6px;
      }

      .ghada-hero-title {
        margin: 0;
        font-size: clamp(1.5rem, 3vw, 2.3rem);
        font-weight: 800;
      }

      .ghada-hero-subtitle {
        margin: 8px 0 0;
        font-size: 0.95rem;
        color: rgba(255, 255, 255, 0.85);
      }

      .ghada-nav {
        position: relative;
        z-index: 1;
        margin-top: 18px;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
        background: rgba(255, 255, 255, 0.12);
        border-radius: 16px;
        padding: 10px;
        border: 1px solid rgba(255, 255, 255, 0.18);
        backdrop-filter: blur(14px);
      }

      .ghada-nav-item {
        border: none;
        background: rgba(255, 255, 255, 0.18);
        color: #fff;
        padding: 10px 14px;
        border-radius: 14px;
        min-width: 110px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        font-weight: 600;
        transition: transform 0.2s ease, background 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
        font-size: 0.9rem;
      }

      .ghada-nav-item .emoji {
        font-size: 1.3rem;
        line-height: 1;
      }

      .ghada-nav-item .label {
        font-size: 0.85rem;
      }

      .ghada-nav-item:hover {
        transform: translateY(-2px);
        background: rgba(255, 255, 255, 0.3);
      }

      .ghada-nav-item.active {
        background: #fff;
        color: var(--primary-color);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2);
      }

      .ghada-nav-item:focus-visible {
        outline: 2px solid #fff;
        outline-offset: 3px;
      }

      @media (max-width: 768px) {
        .ghada-hero-content {
          flex-direction: column;
          align-items: flex-start;
        }

        .ghada-nav-item {
          flex: 1 1 calc(50% - 6px);
          min-width: 100px;
        }
      }

      @media (max-width: 480px) {
        .ghada-nav-item {
          flex: 1 1 100%;
          align-items: flex-start;
        }
      }

      .payments-wrapper {
        max-width: 950px;
        margin: 0 auto 60px;
        padding: 0 15px;
      }

      .payments-card {
        background: #fff;
        border-radius: 24px;
        padding: 32px;
        box-shadow: var(--card-shadow);
      }

      .payments-card h2 {
        color: var(--primary-dark);
        font-weight: 800;
        margin-bottom: 10px;
        font-size: 1.8rem;
      }

      .payments-card p.lead {
        color: var(--text-muted);
        margin-bottom: 25px;
        font-size: 1rem;
      }

      label.form-label {
        font-weight: 700;
        color: var(--text-dark);
      }

      .form-control,
      .form-select {
        border-radius: 14px;
        padding: 0.75rem 1rem;
        border: 1px solid #e1e5eb;
        text-align: right;
      }

      .form-control:focus,
      .form-select:focus {
        border-color: var(--primary-light);
        box-shadow: 0 0 0 0.2rem rgba(0, 136, 145, 0.15);
      }

      .helper-text {
        font-size: 0.85rem;
        color: var(--text-muted);
      }

      .actions-row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        justify-content: flex-start;
        margin-top: 10px;
      }

      .actions-row .btn {
        min-width: 160px;
        border-radius: 14px;
        font-weight: 700;
        padding: 0.85rem 1.5rem;
      }

      .submit-btn {
        background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        border: none;
      }

      .submit-btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
      }

      .reset-btn {
        border: 1px solid var(--primary-light);
        color: var(--primary-dark);
        background: transparent;
      }

      @media (max-width: 576px) {
        .payments-card {
          padding: 24px;
        }
      }
    </style>
  </head>
  <body data-page="payments">
    <? var headerAppUrl = typeof appUrl !== 'undefined' ? appUrl : getUrl(); ?>
    <header class="ghada-hero" dir="rtl">
      <div class="ghada-hero-content">
        <span class="ghada-hero-emoji" aria-hidden="true">ğŸ’³</span>
        <div class="ghada-hero-text">
          <span class="ghada-hero-badge">Ø¯ÙØ¹Ø§Øª Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</span>
          <h1 class="ghada-hero-title">Ø³Ø¬Ù‘Ù„ ÙˆØ§Ø³ØªØ¹Ø±Ø¶ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¯ÙØ¹ Ø¨Ø³Ù‡ÙˆÙ„Ø©</h1>
          <p class="ghada-hero-subtitle">
            Ø¬Ù…ÙŠØ¹ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù… Ø£Ù…Ø§Ù…Ùƒ Ù…Ø¹ Ù‚Ø§Ø¦Ù…Ø© Ø£Ø®Ù Ø­Ø¬Ù…Ø§Ù‹ ØªÙ†Ø§Ø³Ø¨ ÙƒÙ„ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª.
          </p>
        </div>
      </div>
      <nav class="ghada-nav" id="ghada-nav-bar" aria-label="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠØ©">
        <button class="ghada-nav-item" data-page="index" type="button">
          <span class="emoji" aria-hidden="true">ğŸ“</span>
          <span class="label">Ø¥Ø¶Ø§ÙØ© Ø­Ø¬Ø²</span>
        </button>
        <button class="ghada-nav-item" data-page="Add-client" type="button">
          <span class="emoji" aria-hidden="true">ğŸ‘¤</span>
          <span class="label">Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„</span>
        </button>
        <button class="ghada-nav-item" data-page="add-tour" type="button">
          <span class="emoji" aria-hidden="true">ğŸ§­</span>
          <span class="label">Ø¥Ø¶Ø§ÙØ© Ø±Ø­Ù„Ø©</span>
        </button>
        <button class="ghada-nav-item" data-page="add-hotel" type="button">
          <span class="emoji" aria-hidden="true">ğŸ¨</span>
          <span class="label">Ø¥Ø¶Ø§ÙØ© ÙÙ†Ø¯Ù‚</span>
        </button>
        <button class="ghada-nav-item" data-page="manage-reservations" type="button">
          <span class="emoji" aria-hidden="true">ğŸ“‚</span>
          <span class="label">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</span>
        </button>
        <button class="ghada-nav-item" data-page="SUPPLIER" type="button">
          <span class="emoji" aria-hidden="true">ğŸ¤</span>
          <span class="label">Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</span>
        </button>
        <button class="ghada-nav-item" data-page="manage-statistics" type="button">
          <span class="emoji" aria-hidden="true">ğŸ“Š</span>
          <span class="label">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</span>
        </button>
        <button class="ghada-nav-item" data-page="mediator" type="button">
          <span class="emoji" aria-hidden="true">ğŸ•´ï¸</span>
          <span class="label">Ø§Ù„ÙˆØ³Ø·Ø§Ø¡</span>
        </button>
        <button class="ghada-nav-item" data-page="payments" type="button">
          <span class="emoji" aria-hidden="true">ğŸ’³</span>
          <span class="label">Ø§Ù„Ø¯ÙØ¹Ø§Øª</span>
        </button>
      </nav>
    </header>
    <script>
      (function () {
        const navBar = document.getElementById('ghada-nav-bar');
        if (!navBar) {
          return;
        }
        const rawBaseUrl = '<?= headerAppUrl ?>';
        const baseUrl = rawBaseUrl && rawBaseUrl !== 'undefined'
          ? rawBaseUrl
          : (function () {
              try {
                return window.top.location.href.split('?')[0];
              } catch (error) {
                return '';
              }
            })();
        const currentPage = document.body.dataset.page || 'index';
        navBar.querySelectorAll('.ghada-nav-item').forEach((button) => {
          const targetPage = button.dataset.page;
          if (targetPage === currentPage) {
            button.classList.add('active');
            button.setAttribute('aria-current', 'page');
          }
          button.addEventListener('click', () => {
            if (!targetPage || !baseUrl || targetPage === currentPage) {
              return;
            }
            const targetUrl = targetPage === 'index'
              ? baseUrl
              : `${baseUrl}?page=${targetPage}`;
            window.top.location.href = targetUrl;
          });
        });
      })();
    </script>
    <main class="payments-wrapper">
      <section class="payments-card">
        <h2>ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
        <p class="lead">Ø§Ø±Ø¨Ø· Ø§Ù„Ø¯ÙØ¹Ø§Øª Ù…Ø¹ Ø´ÙŠØª <strong>Payments</strong> ÙˆØ§Ø­ØªÙØ¸ Ø¨Ø³Ø¬Ù„ Ù…ÙˆØ­Ù‘Ø¯ Ù„Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª.</p>

        <form id="payments-form">
          <div class="row g-4">
            <div class="col-md-6">
              <label for="paymentBeneficiary" class="form-label">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯</label>
              <input type="text" class="form-control" id="paymentBeneficiary" name="beneficiary" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ±Ø¯ Ø£Ùˆ Ø§Ù„Ø¬Ù‡Ø©" required />
            </div>
            <div class="col-md-3">
              <label for="paymentAmount" class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº (SAR)</label>
              <input type="number" class="form-control" id="paymentAmount" name="amount" min="0" step="0.01" placeholder="0.00" required />
              <small class="helper-text">Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø±ÙŠØ§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ</small>
            </div>
            <div class="col-md-3">
              <label for="paymentAmountEuro" class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„ÙŠÙˆØ±Ùˆ</label>
              <input type="number" class="form-control" id="paymentAmountEuro" name="amountEuro" min="0" step="0.01" placeholder="0.00" required />
            </div>
            <div class="col-md-6">
              <label for="deliveryMethod" class="form-label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…</label>
              <select class="form-select" id="deliveryMethod" name="deliveryMethod" required>
                <option value="" selected disabled>Ø§Ø®ØªØ± Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©</option>
                <option value="ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ">ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ</option>
                <option value="Ø­ÙˆØ§Ù„Ø©">Ø­ÙˆØ§Ù„Ø©</option>
                <option value="Ø´ÙŠÙƒ">Ø´ÙŠÙƒ</option>
                <option value="Ù†Ù‚Ø¯ÙŠ">Ù†Ù‚Ø¯ÙŠ</option>
                <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="dueDate" class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</label>
              <input type="date" class="form-control" id="dueDate" name="dueDate" required />
            </div>
            <div class="col-md-3">
              <label for="paymentDate" class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹</label>
              <input type="date" class="form-control" id="paymentDate" name="paymentDate" />
              <small class="helper-text">Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¨Ø¹Ø¯</small>
            </div>
          </div>

          <div class="actions-row mt-4">
            <button type="submit" class="btn btn-primary submit-btn" id="submitPaymentButton">Ø­ÙØ¸ Ø§Ù„Ø¯ÙØ¹Ø©</button>
            <button type="reset" class="btn reset-btn">Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
          </div>
        </form>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script>
      (function () {
        const form = document.getElementById('payments-form');
        const submitButton = document.getElementById('submitPaymentButton');

        if (!form || !submitButton) {
          return;
        }

        function toggleLoading(isLoading) {
          submitButton.disabled = isLoading;
          submitButton.textContent = isLoading ? '... Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸' : 'Ø­ÙØ¸ Ø§Ù„Ø¯ÙØ¹Ø©';
        }

        form.addEventListener('submit', function (event) {
          event.preventDefault();
          if (!form.checkValidity()) {
            form.reportValidity();
            return;
          }

          const payload = {
            beneficiary: document.getElementById('paymentBeneficiary').value.trim(),
            amount: document.getElementById('paymentAmount').value.trim(),
            amountEuro: document.getElementById('paymentAmountEuro').value.trim(),
            deliveryMethod: document.getElementById('deliveryMethod').value,
            dueDate: document.getElementById('dueDate').value,
            paymentDate: document.getElementById('paymentDate').value
          };

          toggleLoading(true);
          google.script.run
            .withSuccessHandler(function (message) {
              toggleLoading(false);
              Swal.fire({
                icon: 'success',
                title: 'ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­',
                text: message || 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹Ø© ÙÙŠ Ø´ÙŠØª Payments.',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
              });
              form.reset();
            })
            .withFailureHandler(function (error) {
              toggleLoading(false);
              Swal.fire({
                icon: 'error',
                title: 'ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„Ø¯ÙØ¹Ø©',
                text: (error && error.message) ? error.message : 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.',
                confirmButtonText: 'Ø¥ØºÙ„Ø§Ù‚'
              });
            })
            .addPayment(payload);
        });
      })();
    </script>
  </body>
</html>
